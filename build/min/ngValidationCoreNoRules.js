"use strict";angular.module("ng-validation",[]).factory("ngValidation",["ngValidationRules","ngValidationScenarios",function(a,b){var c=function(b,c){if(c=c||!1,a=a||function(){throw"ngValidation: Dont forget to source the angular-validate-rules file in the DOM!"}(),this.defaults={rule:a.default.rule,async:!1,submit_toggle:"disabled",required:"required",passed_toggle:"passed-validation",failed_toggle:"failed-validation",show_failed_elements:!0,show_passed_elements:!0,show_passed_on_load:!1,show_failed_on_load:!1,groups:!1,group_toggle:"ng-validation-group",exempt:[],custom:!1,on_load:function(){},fail:function(){},success:function(){},validator:!1,submit:!1,scenarios:!1,events:{keydown:["text","password","email","textarea","tel"],keyup:["text","password","email","textarea","tel"],click:["submit","checkbox","radio"],change:["checkbox","radio","select"],paste:["text","password","email","textarea","tel"],blur:["text","password","email","textarea","tel"],mouseenter:[],mouseleave:[]},ignore:["header","div","section","p","ul","li","article","aside","video","audio","h1","h2","h3","h4","h5","h6","hr","span","label","fieldset","legend"]},this.opts=c?this.extend(this.defaults,c):this.defaults,this.vChunk=b,this.pt=this.opts.passed_toggle,this.ft=this.opts.failed_toggle,this.spe=this.opts.show_passed_elements,this.sfe=this.opts.show_failed_elements,this.sfol=this.opts.show_failed_on_load,this.spol=this.opts.show_passed_on_load,this.opts.rule||(console.warn("ngValidation: rule was declared in DOM but not found in angular-validate-rules.js. Falling back to default rule"),this.opts.rule=a.default.rule),this.required=[],this.exempt=[],this.failed=[],this.groups_failed=[],this.loadState=1,this.loadStates={1:"Not Loaded",2:"Loaded"},this.opts.submit)this.sbmt=this.opts.submit;else if(b.querySelectorAll("input[type=submit]").length>0)this.sbmt=b.querySelectorAll("input[type=submit]")[0];else if(b.querySelectorAll("button[type=submit]").length>0)this.sbmt=b.querySelectorAll("button[type=submit]")[0];else if(!this.opts.async)throw"ngValidation: No submit button found and Async mode disabled, are you sure you need validation?";return this.pre_validate(),this};c.prototype.pre_validate=function(){var a=this;if(this.process_exempt(this.opts.exempt),this.opts.groups?this.process_groups():"",this.process_required(this.vChunk),this.sbmt.addEventListener("click",function(b){a.post_validate.call(a,this,b)},!1),this.opts.on_load.call(this),this.opts.scenarios)for(var c=0,d=this.opts.scenarios.length;d>c;c++)new b([this.opts.scenarios[c].name],this.vChunk,this.opts.scenarios[c].options,this);this.required.forEach(function(b,c){a.validate.call(a,b,c)})},c.prototype.process_exempt=function(a){for(var b=[],c=0;c<a.length;c++)if(this.vChunk.querySelectorAll(a[c]).length>0){b=this.vChunk.querySelectorAll(a[c]);for(var d=0;d<b.length;d++)this.exempt.push(b[d])}},c.prototype.process_groups=function(){for(var a,b,c=this,d=this.opts.groups,e=0,f=d.length;f>e;e++)if(d[e].passed=[],d[e].container&&void 0!==d[e].container){if(a=this.vChunk.querySelectorAll(d[e].container),a.length>0)for(var g=0,h=a.length;h>g;g++)if(a[g].setAttribute(this.opts.group_toggle,d[e].name),d[e].required){b=a[g].querySelectorAll(d[e].required);for(var i=0,j=b.length;j>i;i++)this.bind_selectors(b[i],c.group_validate,d[e],c),1===b[i].nodeType&&this.group_validate(b[i],d[e])}else for(var i=0,j=a[g].childNodes.length;j>i;i++)this.bind_selectors(a[g].childNodes[i],c.group_validate,d[e],c),1===a[g].childNodes[i].nodeType&&this.group_validate(a[g].childNodes[i],d[e])}else{if(!d[e].required)throw"No elements in group to parse. Please specify a container or required elements.";a=this.vChunk.querySelectorAll(d[e].required);for(var g=0,h=a.length;h>g;g++)a[g].setAttribute(this.opts.group_toggle,d[e].name),this.bind_selectors(a[g],c.group_validate,d[e],c),1===a[g].nodeType&&this.group_validate(a[g],d[e])}},c.prototype.process_required=function(a){for(var b=this,c=0;c<a.childNodes.length;c++)1!==a.childNodes[c].nodeType||-1!==this.exempt.indexOf(a.childNodes[c])||a.childNodes[c]===this.sbmt||a.childNodes[c].hasAttribute(this.opts.group_toggle)||(-1===this.opts.ignore.indexOf(a.childNodes[c].localName)&&(a.childNodes[c].classList.add(this.opts.required),this.required.push(a.childNodes[c])),this.bind_selectors(a.childNodes[c],b.validate,"",b),this.process_required(a.childNodes[c]))},c.prototype.bind_selectors=function(a,b,c,d){for(var e in this.opts.events)if(this.opts.events[e]!==!1)for(var f=0;f<this.opts.events[e].length;f++)void 0!==a&&a.type===this.opts.events[e][f]&&a.addEventListener(e,function(a){("keydown"!==a.type||"keydown"===a.type&&8===a.keyCode||46===a.keyCode)&&b.call(d,this,c,a)},!1)},c.prototype.validate=function(a,b,c){var d=this.validators[a.type]?a.type:"text";a=a||{},this.validators[d]&&this.validators[d].call(this,a)?this.opts.validator[a.type]?this.opts.validator[a.type].call(this,a,b,c)?this.epic_win(a,!1,c):this.epic_fail(a,!1,c):this.epic_win(a,!1,c):this.epic_fail(a,!1,c),"number"==typeof b&&b===this.required.length-1&&(this.loadState=2)},c.prototype.group_validate=function(a,b,c){var d=this.validators[a.type]?a.type:"text";if(c=c||{},!this.validators[d])throw"ngValidation: specified and fallback validtor not found. Hmmmm, this shouldn't happen.";this.validators[d](a,c)?this.opts.validator[a.type]?this.opts.validator[a.type].call(this,a,c)?(-1===b.passed.indexOf(a)&&b.passed.push(a),this.epic_win(a,!0,c)):(-1!==b.passed.indexOf(a)&&b.passed.splice(b.passed.indexOf(a),1),this.epic_fail(a,!0,c)):(-1===b.passed.indexOf(a)&&b.passed.push(a),this.epic_win(a,!0,c)):(-1!==b.passed.indexOf(a)&&b.passed.splice(b.passed.indexOf(a),1),this.epic_fail(a,!0,c)),b.passed.length>=b.number_required?-1!==this.groups_failed.indexOf(b.name)&&this.groups_failed.splice(this.groups_failed.indexOf(b.name),1):-1===this.groups_failed.indexOf(b.name)&&this.groups_failed.push(b.name)},c.prototype.epic_win=function(a,b,c){b||this.total_passed(a),(a.classList.contains(this.opts.required)||b)&&(2===this.loadState||this.spol&&1===this.loadState)&&(this.spe&&a.classList.add(this.pt),a.classList.remove(this.ft)),this.instance_rule(a,c)},c.prototype.epic_fail=function(a,b,c){b||this.total_failed(a),(a.classList.contains(this.opts.required)||b)&&(2===this.loadState||this.sfol&&1===this.loadState)&&(this.sfe&&a.classList.add(this.ft),a.classList.remove(this.pt)),this.instance_rule(a,c)},c.prototype.instance_rule=function(a,b){a=a||[],b=b||{},this.opts.rule&&(this.opts.rule.call(this,this.vChunk,a,b)?this.sbmt.removeAttribute(this.opts.submit_toggle):this.sbmt.setAttribute(this.opts.submit_toggle,!0))},c.prototype.post_validate=function(a){return a.hasAttribute(this.opts.submit_toggle)?(this.opts.fail.call(this),!1):(this.opts.success.call(this),!0)},c.prototype.total_failed=function(a){-1===this.failed.indexOf(a)&&this.failed.push(a)},c.prototype.total_passed=function(a){-1!==this.failed.indexOf(a)&&this.failed.splice(this.failed.indexOf(a),1)},c.prototype.extend=function(a,b){return function c(a,b){for(var d in b)"object"==typeof a[d]?c(a[d],b[d]):a[d]=b[d]}(a,b),a},c.prototype.validators={text:function(a){var b=a.value;return""!==b&&void 0!==b&&null!==b?!0:!1},email:function(a){var b=a.value;return""!==b&&void 0!==b&&null!==b?b.match(/^[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*/i)?!0:!1:!1},password:function(a){var b=a.value;return""!==b&&void 0!==b&&null!==b?!0:!1},tel:function(a){var b=a.value;return""!==b&&void 0!==b&&null!==b?b.match(/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/)?!0:!1:!1},checkbox:function(a){return a.checked?!0:!1},radio:function(a){return a.checked?!0:!1},textarea:function(a){var b=a.value;return""!==b&&void 0!==b&&null!==b&&null===b.match(/^\n/)?!0:!1}},function(){for(var b="ng-validation",d=a,e=document.querySelectorAll("*["+b+"]"),f=0,g=e.length;g>f;f++)new c(e[f],d[e[f].getAttribute(b)])}()}]),angular.module("ng-validation").factory("ngValidationScenarios",["ngValidationScenariosPasswordStrength",function(a){var b=function(b,c,d,e){var f={password:a};f.hasOwnProperty(b)&&new f[b](c,d,e)};return b}]),angular.module("ng-validation").factory("ngValidationScenariosPasswordStrength",function(){var a=function(a,b,c){var d=this;this.defaults={standards:{strong:{id:3,uppercase:3,number:3,special:3,length:15,ui:"Could defeat a small clan of ninjas."},medium:{id:2,uppercase:1,number:1,special:1,length:8,ui:"Meh"},weak:{id:1,uppercase:0,number:0,special:0,length:5,ui:"pansy"}},acceptance:"strong",ui:""},this.opts=c.extend(this.defaults,b),this.password=a.querySelectorAll('input[type="password"]'),this.state_ui=this.opts.ui?a.querySelectorAll(this.opts.ui)[0]:[],this.strengths={uppercase:"weak",number:"weak",special:"weak"},this.root=c;for(var e=0,f=this.password.length;f>e;e++)c.bind_selectors(this.password[e],d.check_password_strength,this.password[e],d),this.check_password_strength(this.password[e])};return a.prototype.check_password_strength=function(a,b){var c,d=this,e=a.value,f={uppercase:0,number:0,special:0,length:0};f.uppercase=e.replace(/[^A-Z]/g,"").length,f.number=e.replace(/[^0-9]/g,"").length,f.special=e.replace(/[^\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\-|\_|\+|\=|\||\{|\}|\[|\]]/g,"").length,f.length=e.length;for(var g in d.opts.standards)for(var h in d.opts.standards[g])c="weak"==g?"medium":"medium"==g?"strong":!1,"ui"!==h&&"length"!==h&&"id"!==h&&void 0!==f[h]&&(f[h]<=d.opts.standards[g][h]?d.strengths[h]=g:c?f[h]<d.opts.standards[c][h]&&(d.strengths[h]=g):d.strengths[h]=g);this.process_acceptance(a,b)},a.prototype.process_acceptance=function(a,b){var c,d={weak:0,medium:0,strong:0},e=[],f="weak";for(var g in this.strengths)void 0!==d[this.strengths[g]]&&d[this.strengths[g]]++;e=Object.keys(d).map(function(a){return d[a]}),c=Math.max.apply(null,e);for(var h in d)if(d[h]===c){f=h,this.state_ui.textContent=this.opts.standards[f].ui;break}a.value.length>=this.opts.standards[this.opts.acceptance].length?this.opts.standards[f].id>=this.opts.standards[this.opts.acceptance].id?this.root.epic_win(a,!1,b):this.root.epic_fail(a,!1,b):this.root.epic_fail(a,!1,b)},a});